<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostCSS Test Example</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <script type="module">
        import postcss from 'https://jspm.dev/postcss@8.4.32'
        import autoprefixer from 'https://jspm.dev/autoprefixer@10.0.2'
        import calc from 'https://jspm.dev/postcss-calc@9.0.1'
        import simpleVars from 'https://jspm.dev/postcss-simple-vars@7.0.1'

        // Process all style elements with type="text/postcss"
        document.addEventListener('DOMContentLoaded', () => {
            const postCssStyleElements = document.querySelectorAll('style[type="text/postcss"]');

            postCssStyleElements.forEach(styleElement => {
                const cssContent = styleElement.textContent;

                postcss([autoprefixer, calc, simpleVars])
                    .process(cssContent, { from: undefined })
                    .then(result => {
                        // Create a new style element with the processed CSS
                        const processedStyleElement = document.createElement('style');
                        processedStyleElement.setAttribute('type', 'text/css');
                        processedStyleElement.textContent = result.css;

                        // Insert the new style element after the original one
                        styleElement.parentNode.insertBefore(processedStyleElement, styleElement.nextSibling);

                        // Optionally hide the original style element
                        styleElement.setAttribute('media', 'not all');

                        console.log("Processed PostCSS style element:", result.css);
                    })
                    .catch(error => {
                        console.error("Error processing PostCSS:", error);
                    });
            });
        });
    </script>
    <!-- This style element will be processed by PostCSS -->
    <style type="text/postcss">
        /* PostCSS will process this CSS - minimal version */

        /* Using calc() which will be processed by postcss-calc */
        .postcss-demo {
            width: calc(100% - 40px);
            margin: calc(16px * 1.5) auto;
            padding: calc(10px + 5px);
        }

        /* Using properties that might need vendor prefixes */
        .postcss-demo-item {
            user-select: none;
            backdrop-filter: blur(5px);
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }

        .postcss-demo-item:hover {
            transform: scale(1.02);
        }

        /* Using nested selectors (if supported by plugins) */
        .accordion {
            height: 0;
            overflow: hidden;
            transition: height 0.3s ease-in-out;
        }

        .accordion.open {
            height: calc(100px + 20px);
        }
    </style>

    <!-- Minimal CSS that won't be processed by PostCSS -->
    <style>
        /* Only keeping styles that are essential and not provided by PicoCSS */
        .container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        /* Media query example */
        @media (max-width: 600px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<header>
    <h1>PostCSS Test Example</h1>
    <p>This is a sample HTML file to demonstrate PostCSS capabilities.</p>
</header>

<main>
    <section>
        <h2>Features Demonstrated</h2>
        <ul>
            <li>CSS Variables (Custom Properties)</li>
            <li>Nested CSS</li>
            <li>Grid Layout</li>
            <li>CSS Functions</li>
            <li>Media Queries</li>
            <li>Transitions and Transforms</li>
        </ul>
    </section>

    <section class="container">
        <article class="card">
            <h3>Card One</h3>
            <div>
                <p>This is an example card that demonstrates styling with CSS variables and transitions.</p>
            </div>
            <a href="#" role="button">Learn More</a>
        </article>

        <article class="card">
            <h3>Card Two</h3>
            <div>
                <p>PostCSS allows you to use future CSS features today through plugins.</p>
            </div>
            <a href="#" role="button" class="secondary">Explore</a>
        </article>

        <article class="card">
            <h3>Card Three</h3>
            <div>
                <p>This layout uses CSS Grid which can be enhanced with PostCSS grid plugins.</p>
            </div>
            <a href="#" role="button">Details</a>
        </article>
    </section>

    <section>
        <h2>About PostCSS</h2>
        <p>PostCSS is a tool for transforming CSS with JavaScript plugins. These plugins can:</p>
        <ul>
            <li>Support variables and mixins</li>
            <li>Transpile future CSS syntax</li>
            <li>Add vendor prefixes automatically</li>
            <li>Optimize and minify CSS</li>
            <li>And much more!</li>
        </ul>
    </section>

    <section>
        <h2>PostCSS Demo</h2>
        <p>The following elements are styled using CSS processed by PostCSS:</p>

        <div class="postcss-demo">
            <article class="postcss-demo-item">
                <h3>PostCSS Feature: Calc</h3>
                <p>This element uses calc() functions that are processed by postcss-calc.</p>
                <p>Original: <code>width: calc(100% - 40px);</code></p>
            </article>

            <article class="postcss-demo-item">
                <h3>PostCSS Feature: Autoprefixer</h3>
                <p>This element uses properties that might need vendor prefixes.</p>
                <p>Original: <code>user-select: none; backdrop-filter: blur(5px);</code></p>
            </article>

            <article class="postcss-demo-item">
                <h3>PostCSS Feature: Transform</h3>
                <p>Hover over this element to see a transform effect.</p>
                <p>Original: <code>transform: scale(1.02);</code></p>
            </article>

            <div class="accordion" id="accordion-demo">
                <h3>PostCSS Feature: Accordion</h3>
                <p>This is a collapsible section using height calculations.</p>
                <p>Click the button below to toggle.</p>
            </div>
            <button onclick="document.getElementById('accordion-demo').classList.toggle('open')">Toggle Accordion</button>
        </div>
    </section>
</main>

<footer>
    <p>&copy; 2025 - Anders Sveen. This is just a demonstration.</p>
</footer>
</body>
</html>
